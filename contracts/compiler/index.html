<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Compiler - STABILA Documentation</title>
  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Compiler";
    var mkdocs_page_input_path = "contracts/compiler.md";
    var mkdocs_page_url = "/documentation-en/contracts/compiler/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> STABILA Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Introduction</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../introduction/">Repository</a>
                </li>
                <li class="">
                    
    <a class="" href="../../introduction/dpos/">DPoS</a>
                </li>
                <li class="">
                    
    <a class="" href="../../introduction/overview/">Overview</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">API</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../api/http/">HTTP API</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/rpc/">RPC API</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Mechanism & Algorithm</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../mechanism-algorithm/gov/">GOV and Committee</a>
                </li>
                <li class="">
                    
    <a class="" href="../../mechanism-algorithm/src10/">SRC-10</a>
                </li>
                <li class="">
                    
    <a class="" href="../../mechanism-algorithm/account/">Account Model</a>
                </li>
                <li class="">
                    
    <a class="" href="../../mechanism-algorithm/resource/">Resource Model</a>
                </li>
                <li class="">
                    
    <a class="" href="../../mechanism-algorithm/dex/">Decentralized Exchange</a>
                </li>
                <li class="">
                    
    <a class="" href="../../mechanism-algorithm/multi-signatures/">Multi-Signature</a>
                </li>
                <li class="">
                    
    <a class="" href="../../mechanism-algorithm/shielded-SRC20-contract/">Shielded SRC20 Contract</a>
                </li>
                <li class="">
                    
    <a class="" href="../../mechanism-algorithm/system-contracts/">System Contracts</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Architecture</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../architecture/network/">Network</a>
                </li>
                <li class="">
                    
    <a class="" href="../../architecture/database/">Database</a>
                </li>
                <li class="">
                    
    <a class="" href="../../architecture/event/">Event Subsystem</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Smart Contract</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../svm/">SVM</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Compiler</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#compiler">Compiler</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#tools">Tools</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../contract/">Contract</a>
                </li>
                <li class="">
                    
    <a class="" href="../src20/">SRC-20</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Developers</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../developers/official-public-nodes/">Official Public Nodes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/deployment/">Deployment</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/run-in-idea/">Run FullNode in IDEA</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/litefullnode/">Run Lite FullNode</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/resources/">Resources</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/contribution/">Contribution</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/java-stabila/">Java-Stabila</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/advanced-configuration/">Advanced Configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/gpg/">Contact Us (GPG Key)</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Clients</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../clients/wallet-cli/">Wallet-cli</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Releases</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../releases/">Binary Integrity Check</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../faq/">FAQ</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../glossary/">Glossary</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">STABILA Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Smart Contract &raquo;</li>
        
      
    
    <li>Compiler</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/stabilaprotocol/documentation-en/edit/master/docs/contracts/compiler.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="compiler">Compiler<a class="headerlink" href="#compiler" title="Permanent link">&para;</a></h1>
<h2 id="tools">Tools<a class="headerlink" href="#tools" title="Permanent link">&para;</a></h2>
<p><strong> Build and install the Solidity compiler </strong></p>
<p>Instructions about how to build and install the Solidity compiler can be found at https://github.com/stabilaprotocol/solidity</p>
<p><strong> Write your first smart contract </strong></p>
<div class="codehilite"><pre><span></span>pragma solidity &lt;=0.8.0;
contract DataStore {

    mapping(uint256 =&gt; uint256) data;

    function set(uint256 key, uint256 value) public {
        data[key] = value;
    }

    function get(uint256 key) view public returns (uint256 value) {
        value = data[key];
    }
}
</pre></div>


<p><strong> Compile smart contract </strong></p>
<div class="codehilite"><pre><span></span>shell
cd solidity/build/solc
./solc --bin --abi -o {outputFolder} {contractFileName}
# example
./solc --bin --abi -o /home/user/solidity/build/solc/dataStore DataStore.sol
If it is compiled successfully /test folder will contain DataStore.api and DataStore.bin files.
</pre></div>


<p><strong> Deploy pricing </strong></p>
<p>Deploying smart contract costs 1000 STB.</p>
<p><strong> Using Wallet-cli to Deploy </strong></p>
<p>Download Wallet-Cli and build</p>
<div class="codehilite"><pre><span></span>shell
# download source code
git clone https://github.com/stabilaprotocol/wallet-cli
cd wallet-cli
# build
./gradlew build
cd build/libs
</pre></div>


<p>Note: You need to change the node ip and port in config.conf, details can be found at https://github.com/stabilaprotocol/wallet-cli</p>
<p>start wallet-cli</p>
<div class="codehilite"><pre><span></span>java -jar wallet-cli.jar
</pre></div>


<p>after started, you can use command lines to operate:</p>
<div class="codehilite"><pre><span></span>importwallet
&lt;input your password twice for your account&gt;
&lt;input your private key&gt;
login
&lt;input your password you set&gt;
getbalance
</pre></div>


<p>deploy contract</p>
<div class="codehilite"><pre><span></span>Shell
# contract deployment command
DeployContract contractName ABI byteCode constructor params isHex fee_limit consume_user_resource_percent &lt;value&gt; &lt;library:address,library:address,...&gt;

# parameters
contract_name: Contract name
ABI: ABI generated by Solidity compiler
bytecode: ByteCode generated by Solidity compiler
constructor: When deploy contract, this will be called. If is needed, write as constructor(uint256,string). If not, just write #
params: The parameters of the constructor, use &#39;,&#39; to split, like  1, &quot;test&quot;, if no constructor, just write #
fee_limit: The STB consumption limit for the deployment, unit is UNIT(1 UNIT = 10^-6 STB)
consume_user_resource_percent: Consume user&#39;s resource percentage. It should be an integer between [0, 100]. if 0, means it does not consume user&#39;s resource until the developer&#39;s resource has been used up
value: The amount of STB transfer to the contract when deploy
library: If the contract contains library, you need to specify the library address

# example
deploycontract DataStore [{&quot;constant&quot;:false,&quot;inputs&quot;:[{&quot;name&quot;:&quot;key&quot;,&quot;type&quot;:&quot;uint256&quot;},{&quot;name&quot;:&quot;value&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;set&quot;,&quot;outputs&quot;:[],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;nonpayable&quot;,&quot;type&quot;:&quot;function&quot;},{&quot;constant&quot;:true,&quot;inputs&quot;:[{&quot;name&quot;:&quot;key&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;name&quot;:&quot;get&quot;,&quot;outputs&quot;:[{&quot;name&quot;:&quot;value&quot;,&quot;type&quot;:&quot;uint256&quot;}],&quot;payable&quot;:false,&quot;stateMutability&quot;:&quot;view&quot;,&quot;type&quot;:&quot;function&quot;}] 608060405234801561001057600080fd5b5060de8061001f6000396000f30060806040526004361060485763ffffffff7c01000000000000000000000000000000000000000000000000000000006000350416631ab06ee58114604d5780639507d39a146067575b600080fd5b348015605857600080fd5b506065600435602435608e565b005b348015607257600080fd5b50607c60043560a0565b60408051918252519081900360200190f35b60009182526020829052604090912055565b600090815260208190526040902054905600a165627a7a72305820fdfe832221d60dd582b4526afa20518b98c2e1cb0054653053a844cf265b25040029 # # false 1000000 30 0
If it is deployed successfully, it will return &#39;Deploy the contract successfully&#39;
</pre></div>


<p>get the contract address</p>
<div class="codehilite"><pre><span></span>Your smart contract address will be: &lt;contract address&gt;

# in this example
Your smart contract address will be: TTWq4vMEYB2yibAbPV7gQ4mrqTyX92fha6
</pre></div>


<p>call the contract to store data, query data</p>
<div class="codehilite"><pre><span></span>Shell
# call contract command
triggercontract &lt;contract_address&gt; &lt;method&gt; &lt;args&gt; &lt;is_hex&gt; &lt;fee_limit&gt; &lt;value&gt;

# parameters
contract_address: Contract address, like TTWq4vMEYB2yibAbPV7gQ4mrqTyX92fha6
method: The method called, like set(uint256,uint256) or fool(), use &#39;,&#39; to split the parameters. Do not leave space between parameters
args: The parameters passed to the method called, use &#39;,&#39; to split the parameters. Do not leave space between parameters
is_hex: whether the input parameters is Hex, false or true
fee_limit: The STB consumption limit for the trigger, unit is UNIT(1 UNIT = 10^-6 STB)
value: The amount of STB transfer to the contract when trigger

# trigger example
## set mapping 1-&gt;1
triggercontract TTWq4vMEYB2yibAbPV7gQ4mrqTyX92fha6 set(uint256,uint256) 1,1 false 1000000  0000000000000000000000000000000000000000000000000000000000000000

## get mapping key = 1
triggercontract TTWq4vMEYB2yibAbPV7gQ4mrqTyX92fha6 get(uint256) 1 false 1000000  0000000000000000000000000000000000000000000000000000000000000000
</pre></div>


<p>If the function called is constant or view, wallet-cli will return the result directly.
If it contains library, before deploy the contract you need to deploy the library first. After you deploy library, you can get the library address, then fill the address in library:address,library:address,...</p>
<div class="codehilite"><pre><span></span># for instance, using remix to get the bytecode of the contract, like:
608060405234801561001057600080fd5b5061013f806100206000396000f300608060405260043610610041576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff168063f75dac5a14610046575b600080fd5b34801561005257600080fd5b5061005b610071565b6040518082815260200191505060405180910390f35b600073&lt;b&gt;__browser/oneLibrary.sol.Math3__________&lt;\b&gt;634f2be91f6040518163ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040160206040518083038186803b1580156100d357600080fd5b505af41580156100e7573d6000803e3d6000fd5b505050506040513d60208110156100fd57600080fd5b81019080805190602001909291905050509050905600a165627a7a7230582052333e136f236d95e9d0b59c4490a39e25dd3a3dcdc16285820ee0a7508eb8690029
</pre></div>


<p>The address of the library deployed before is: SSEJ29gnBkxQZR3oDdLdeQtQQykpVLSk54
When you deploy, you need to use browser/oneLibrary.sol.Math3:SSEJ29gnBkxQZR3oDdLdeQtQQykpVLSk54 as the parameter of deploycontract.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../contract/" class="btn btn-neutral float-right" title="Contract">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../svm/" class="btn btn-neutral" title="SVM"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/stabilaprotocol/documentation-en/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../svm/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../contract/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
