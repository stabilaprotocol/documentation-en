<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Account Model - STABILA Documentation</title>
  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Account Model";
    var mkdocs_page_input_path = "mechanism-algorithm/account.md";
    var mkdocs_page_url = "/documentation-en/mechanism-algorithm/account/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> STABILA Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Introduction</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../introduction/">Repository</a>
                </li>
                <li class="">
                    
    <a class="" href="../../introduction/dpos/">DPoS</a>
                </li>
                <li class="">
                    
    <a class="" href="../../introduction/overview/">Overview</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">API</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../api/http/">HTTP API</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/rpc/">RPC API</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Mechanism & Algorithm</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../sr/">SR and Committee</a>
                </li>
                <li class="">
                    
    <a class="" href="../trc10/">TRC-10</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Account Model</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#account-model">Account Model</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#introduction">Introduction</a></li>
        
            <li><a class="toctree-l4" href="#how-to-create-an-account">How to Create an Account</a></li>
        
            <li><a class="toctree-l4" href="#key-pair-generation">Key-pair Generation</a></li>
        
            <li><a class="toctree-l4" href="#address-format">Address Format</a></li>
        
            <li><a class="toctree-l4" href="#signature">Signature</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../resource/">Resource Model</a>
                </li>
                <li class="">
                    
    <a class="" href="../dex/">Decentralized Exchange</a>
                </li>
                <li class="">
                    
    <a class="" href="../multi-signatures/">Multi-Signature</a>
                </li>
                <li class="">
                    
    <a class="" href="../shielded-TRC20-contract/">Shielded TRC20 Contract</a>
                </li>
                <li class="">
                    
    <a class="" href="../system-contracts/">System Contracts</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Architecture</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../architecture/network/">Network</a>
                </li>
                <li class="">
                    
    <a class="" href="../../architecture/database/">Database</a>
                </li>
                <li class="">
                    
    <a class="" href="../../architecture/event/">Event Subsystem</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Smart Contract</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../contracts/svm/">SVM</a>
                </li>
                <li class="">
                    
    <a class="" href="../../contracts/compiler/">Compiler</a>
                </li>
                <li class="">
                    
    <a class="" href="../../contracts/contract/">Contract</a>
                </li>
                <li class="">
                    
    <a class="" href="../../contracts/trc20/">TRC-20</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Developers</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../developers/official-public-nodes/">Official Public Nodes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/deployment/">Deployment</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/run-in-idea/">Run FullNode in IDEA</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/litefullnode/">Run Lite FullNode</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/resources/">Resources</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/contribution/">Contribution</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/java-stabila/">Java-Stabila</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/advanced-configuration/">Advanced Configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/gpg/">Contact Us (GPG Key)</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Clients</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../clients/wallet-cli/">Wallet-cli</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Releases</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../releases/">Binary Integrity Check</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../faq/">FAQ</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../glossary/">Glossary</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">STABILA Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Mechanism & Algorithm &raquo;</li>
        
      
    
    <li>Account Model</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/stabilaprotocol/documentation-en/edit/master/docs/mechanism-algorithm/account.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="account-model">Account Model<a class="headerlink" href="#account-model" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>STABILA uses account model. An account's identity is address. It needs private key signature to operate an account. An account has many attributes, like STB balance, tokens balance, bandwidth, etc. STB and tokens can be transfered from account to account and it costs bandwidth. An account can also issue a smart contract, apply to become a governor candidate, vote, etc. All STABILA's activities are based on account.</p>
<h2 id="how-to-create-an-account">How to Create an Account<a class="headerlink" href="#how-to-create-an-account" title="Permanent link">&para;</a></h2>
<ol>
<li>Use a wallet to generate the address and private key. To activate the account, you need to transfer STB or transfer token to the new created account. <a href="https://stabilascan.org/signup">Generate an account</a></li>
<li>Use an account already existed in STABILA network to create an account</li>
</ol>
<p>If you have enough staked BandWidth Points, creating an account only consume your staked BandWidth Points, otherwise, it burns 0.1 STB.</p>
<h2 id="key-pair-generation">Key-pair Generation<a class="headerlink" href="#key-pair-generation" title="Permanent link">&para;</a></h2>
<p>Stabila signature algorithm is ECDSA, curve used is SECP256K1. Private key is a random number, public key is a point in the elliptic curve. The process is: first generate a random number d to be the private key, then calculate P = d * G as the public key, G is the elliptic curve base point.</p>
<h2 id="address-format">Address Format<a class="headerlink" href="#address-format" title="Permanent link">&para;</a></h2>
<p>Use the public key P as the input, by SHA3 get the result H. The length of the public key is 64 bytes, SHA3 uses Keccak256. Use the last 20 bytes of H, and add a byte of 0x41 in front of it, then the address come out. Do basecheck to address, here is the final address. All addresses start with 'T'.</p>
<p>basecheck process: first do sha256 calculation to address to get h1, then do sha256 to h1 to get h2, use the first 4 bytes as check to add it to the end of the address to get address||check, do base58 encode to address||check to get the final result.</p>
<p>character map:
ALPHABET = "123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"</p>
<h2 id="signature">Signature<a class="headerlink" href="#signature" title="Permanent link">&para;</a></h2>
<h3 id="steps">Steps<a class="headerlink" href="#steps" title="Permanent link">&para;</a></h3>
<ol>
<li>Get the raw data of the transaction, then transfer it to <code>byte[]</code></li>
<li>Do sha256 calculation to the raw data</li>
<li>Use the private key to sign the result gained from step 2</li>
<li>Add the signature back into the transaction</li>
</ol>
<h3 id="algorithm">Algorithm<a class="headerlink" href="#algorithm" title="Permanent link">&para;</a></h3>
<ol>
<li>ECDSA, SECP256K</li>
<li>
<p>Example:</p>
<p><code>text
priKey:::8e812436a0e3323166e1f0e8ba79e19e217b2c4a53c970d4cca0cfb1078979df
pubKey::04a5bb3b28466f578e6e93fbfd5f75cee1ae86033aa4bbea690e3312c087181eb366f9a1d1d6a437a9bf9fc65ec853b9fd60fa322be3997c47144eb20da658b3d1
hash:::159817a085f113d099d3d93c051410e9bfe043cc5c20e43aa9a083bf73660145
r:::38b7dac5ee932ac1bf2bc62c05b792cd93c3b4af61dc02dbb4b93dacb758123f
s:::08bf123eabe77480787d664ca280dc1f20d9205725320658c39c6c143fd5642d
v:::0</code></p>
<p>Note: The size of the signature result is 65 bytes. r 32 bytes, s 32 bytes, v 1 bytes.</p>
</li>
<li>
<p>fullnode will verify the signature, it generates an address with the value of hash and r、s、v, then it compares with the address in the transaction.</p>
</li>
</ol>
<h3 id="demo">Demo<a class="headerlink" href="#demo" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">static</span> <span class="n">Transaction</span> <span class="nf">sign</span><span class="o">(</span><span class="n">Transaction</span> <span class="n">transaction</span><span class="o">,</span> <span class="n">ECKey</span> <span class="n">myKey</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Transaction</span><span class="o">.</span><span class="na">Builder</span> <span class="n">transactionBuilderSigned</span> <span class="o">=</span> <span class="n">transaction</span><span class="o">.</span><span class="na">toBuilder</span><span class="o">();</span>
    <span class="kt">byte</span><span class="o">[]</span> <span class="n">hash</span> <span class="o">=</span> <span class="n">sha256</span><span class="o">(</span><span class="n">transaction</span><span class="o">.</span><span class="na">getRawData</span><span class="o">().</span><span class="na">toByteArray</span><span class="o">());</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Contract</span><span class="o">&gt;</span> <span class="n">listContract</span> <span class="o">=</span> <span class="n">transaction</span><span class="o">.</span><span class="na">getRawData</span><span class="o">().</span><span class="na">getContractList</span><span class="o">();</span>

    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">listContract</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
        <span class="n">ECDSASignature</span> <span class="n">signature</span> <span class="o">=</span> <span class="n">myKey</span><span class="o">.</span><span class="na">sign</span><span class="o">(</span><span class="n">hash</span><span class="o">);</span>
        <span class="n">ByteString</span> <span class="n">bsSign</span> <span class="o">=</span> <span class="n">ByteString</span><span class="o">.</span><span class="na">copyFrom</span><span class="o">(</span><span class="n">signature</span><span class="o">.</span><span class="na">toByteArray</span><span class="o">());</span>

        <span class="c1">// Each contract may be signed with a different private key in the future.</span>
        <span class="n">transactionBuilderSigned</span><span class="o">.</span><span class="na">addSignature</span><span class="o">(</span><span class="n">bsSign</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../resource/" class="btn btn-neutral float-right" title="Resource Model">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../trc10/" class="btn btn-neutral" title="TRC-10"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/stabilaprotocol/documentation-en/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../trc10/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../resource/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
