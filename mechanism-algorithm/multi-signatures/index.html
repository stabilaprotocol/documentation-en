<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Multi-Signature - STABILA Documentation</title>
  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Multi-Signature";
    var mkdocs_page_input_path = "mechanism-algorithm/multi-signatures.md";
    var mkdocs_page_url = "/documentation-en/mechanism-algorithm/multi-signatures/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> STABILA Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Introduction</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../introduction/">Repository</a>
                </li>
                <li class="">
                    
    <a class="" href="../../introduction/dpos/">DPoS</a>
                </li>
                <li class="">
                    
    <a class="" href="../../introduction/overview/">Overview</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">API</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../api/http/">HTTP API</a>
                </li>
                <li class="">
                    
    <a class="" href="../../api/rpc/">RPC API</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Mechanism & Algorithm</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../gov/">GOV and Committee</a>
                </li>
                <li class="">
                    
    <a class="" href="../src10/">SRC-10</a>
                </li>
                <li class="">
                    
    <a class="" href="../account/">Account Model</a>
                </li>
                <li class="">
                    
    <a class="" href="../resource/">Resource Model</a>
                </li>
                <li class="">
                    
    <a class="" href="../dex/">Decentralized Exchange</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Multi-Signature</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#multi-signature">Multi-signature</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#background">Background</a></li>
        
            <li><a class="toctree-l4" href="#concept">Concept</a></li>
        
            <li><a class="toctree-l4" href="#api">API</a></li>
        
            <li><a class="toctree-l4" href="#others">Others</a></li>
        
            <li><a class="toctree-l4" href="#fees">Fees</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../shielded-SRC20-contract/">Shielded SRC20 Contract</a>
                </li>
                <li class="">
                    
    <a class="" href="../system-contracts/">System Contracts</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Architecture</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../architecture/network/">Network</a>
                </li>
                <li class="">
                    
    <a class="" href="../../architecture/database/">Database</a>
                </li>
                <li class="">
                    
    <a class="" href="../../architecture/event/">Event Subsystem</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Smart Contract</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../contracts/svm/">SVM</a>
                </li>
                <li class="">
                    
    <a class="" href="../../contracts/compiler/">Compiler</a>
                </li>
                <li class="">
                    
    <a class="" href="../../contracts/contract/">Contract</a>
                </li>
                <li class="">
                    
    <a class="" href="../../contracts/src20/">SRC-20</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Developers</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../developers/official-public-nodes/">Official Public Nodes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/deployment/">Deployment</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/run-in-idea/">Run FullNode in IDEA</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/litefullnode/">Run Lite FullNode</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/resources/">Resources</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/contribution/">Contribution</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/java-stabila/">Java-Stabila</a>
                </li>
                <li class="">
                    
    <a class="" href="../../developers/advanced-configuration/">Advanced Configuration</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Clients</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../clients/wallet-cli/">Wallet-cli</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Releases</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../releases/">Binary Integrity Check</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../faq/">FAQ</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../glossary/">Glossary</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">STABILA Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Mechanism & Algorithm &raquo;</li>
        
      
    
    <li>Multi-Signature</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/stabilaprotocol/documentation-en/edit/master/docs/mechanism-algorithm/multi-signatures.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="multi-signature">Multi-signature<a class="headerlink" href="#multi-signature" title="Permanent link">&para;</a></h1>
<h2 id="background">Background<a class="headerlink" href="#background" title="Permanent link">&para;</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Since v3.5</strong> In the past version, the transactions created in one account can only be signed by one private key, an account can only be managed by one private key. Since V3.5, an account can be managed by several private keys, and the transactions created in one account can be signed by several private keys.</p>
</div>
<h2 id="concept">Concept<a class="headerlink" href="#concept" title="Permanent link">&para;</a></h2>
<p>There are three types of permission: owner, executive and active. Owner permission has the right to execute all the contracts. Executive permission is for Governor. Active permission contains a set of contracts selected execution permissions.</p>
<h3 id="protocol-definition">Protocol Definition<a class="headerlink" href="#protocol-definition" title="Permanent link">&para;</a></h3>
<h4 id="account">Account<a class="headerlink" href="#account" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="kd">message</span> <span class="nc">Account</span> <span class="p">{</span>
  <span class="c1">// ...</span>
  <span class="n">Permission</span> <span class="na">owner_permission</span> <span class="o">=</span> <span class="mi">31</span><span class="p">;</span>
  <span class="n">Permission</span> <span class="na">executive_permission</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span>
  <span class="k">repeated</span> <span class="n">Permission</span> <span class="na">active_permission</span> <span class="o">=</span> <span class="mi">33</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>Three attributes are added, owner_permission, executive_permission and active_permission. active_permission is a list, the length can not be bigger than 8.</p>
<h4 id="contracttype">ContractType<a class="headerlink" href="#contracttype" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="kd">message</span> <span class="nc">Transaction</span> <span class="p">{</span>
  <span class="kd">message</span> <span class="nc">Contract</span> <span class="p">{</span>
    <span class="kd">enum</span> <span class="n">ContractType</span> <span class="p">{</span>
      <span class="na">AccountCreateContract</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="c1">// ...</span>
      <span class="na">AccountPermissionUpdateContract</span> <span class="o">=</span> <span class="mi">46</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>AccountPermissionUpdateContract is a new contract type used to update the account permission.</p>
<h4 id="accountpermissionupdatecontract">AccountPermissionUpdateContract<a class="headerlink" href="#accountpermissionupdatecontract" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="kd">message</span> <span class="nc">AccountPermissionUpdateContract</span> <span class="p">{</span>
  <span class="kt">bytes</span> <span class="na">owner_address</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">Permission</span> <span class="na">owner</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="n">Permission</span> <span class="na">executive</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
  <span class="k">repeated</span> <span class="n">Permission</span> <span class="na">actives</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<ul>
<li><code>owner_address</code>: The account applies multi-signatures</li>
<li><code>owner</code>: Owner permission</li>
<li><code>executive</code>: Executive permission (if is executive)</li>
<li><code>actives</code>: Active permission</li>
</ul>
<p>This will override the Original account permission.</p>
<h4 id="permission">Permission<a class="headerlink" href="#permission" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="kd">message</span> <span class="nc">Permission</span> <span class="p">{</span>
  <span class="kd">enum</span> <span class="n">PermissionType</span> <span class="p">{</span>
    <span class="na">Owner</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="na">Executive</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="na">Active</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">PermissionType</span> <span class="na">type</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="kt">int32</span> <span class="na">id</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="kt">string</span> <span class="na">permission_name</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
  <span class="kt">int64</span> <span class="na">threshold</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
  <span class="kt">int32</span> <span class="na">parent_id</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
  <span class="kt">bytes</span> <span class="na">operations</span> <span class="o">=</span> <span class="mi">6</span><span class="p">;</span>
  <span class="k">repeated</span> <span class="n">Key</span> <span class="na">keys</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<ul>
<li><code>PermissionType</code>: Permission type</li>
<li><code>id</code>: Generated by system. Owner id=0, Executive id=1, Active id increases from 2. Specifying using which permission to execute a contract by setting id. For instance, using owner permission, set id=0</li>
<li><code>permission_name</code>: Permission name, 32 bytes length limit</li>
<li><code>threshold</code>: The threshold of the signature weight</li>
<li><code>parent_id</code>: Current 0</li>
<li>
<p><code>operations</code>: 32 bytes (256 b), each bit represent the execution permission of one contract, 1 means it owns the execution permission of the contract.</p>
<p>For instance, operations=0x0100...00(hex), 100...0(binary), refer to the definition of Transaction.ContractType in proto, the id of AccountCreateContract is 0, means this permission only owns the execution permission of AccountCreateContract</p>
</li>
<li>
<p><code>keys</code>: The accounts and weights that all own the permission, 5 keys at most.</p>
</li>
</ul>
<h4 id="key">Key<a class="headerlink" href="#key" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="kd">message</span> <span class="nc">Key</span> <span class="p">{</span>
  <span class="kt">bytes</span> <span class="na">address</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="kt">int64</span> <span class="na">weight</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<ul>
<li><code>address</code>: The account address</li>
<li><code>weight</code>: The signature weight</li>
</ul>
<h4 id="transaction">Transaction<a class="headerlink" href="#transaction" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="kd">message</span> <span class="nc">Transaction</span> <span class="p">{</span>
  <span class="c1">// ...</span>
  <span class="kt">int32</span> <span class="na">Permission_id</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p><code>Permission_id</code> is added. It is corresponding to <code>Permission.id</code>
1 is not allowed, because executive permission is only used to produce blocks, not for transaction signature.</p>
<h3 id="owner-permission">Owner Permission<a class="headerlink" href="#owner-permission" title="Permanent link">&para;</a></h3>
<p>Owner permission is the top permission of an account. It is used to control account ownership, adjust permission  structure. Owner Permission has the right to execute all the contracts.</p>
<p>Owner permission's features:</p>
<ol>
<li>The account that has owner permission can change the owner permission</li>
<li>When owner permission is null, the default owner of the account owns the owner permission</li>
<li>When you create a new account, the address will be insert into owner permission automatically, default weight is 1, keys field only contains this address and also weight is 1.</li>
<li>If a permissionId is not specified when a contract is executed, using owner permission by defualt.</li>
</ol>
<h3 id="executive-permission">Executive Permission<a class="headerlink" href="#executive-permission" title="Permanent link">&para;</a></h3>
<p>Governors can use this permission to manage block producing. Only executive account has this permission.</p>
<p>Usage scenario example:
A governor deploys a executive node on cloud server. In order to keep the account on the cloud server safe, you can only give the block producing permission to the account you put on cloud server. Because this account only owns  block producing permission, no STB transfer permission, so even if the account on the cloud server is leaked, the STB will not be lost.</p>
<p>Executive node configuration:</p>
<ol>
<li>if no executive permission is used, no need to configure</li>
<li>if itness permission is used, need to reconfigure:</li>
</ol>
<div class="codehilite"><pre><span></span># config.conf

// Optional.The default is empty.
// It is used when the executive account has set the executivePermission.
// When it is not empty, the localExecutiveAccountAddress represents the address of the executive account,
// and the localexecutive is configured with the private key of the executivePermissionAddress in the executive account.
// When it is empty,the localexecutive is configured with the private key of the executive account.

//localExecutiveAccountAddress =

localexecutive = [
  f4df789d3210ac881cb900464dd30409453044d2777060a0c391cbdf4c6a4f57
]
</pre></div>


<h3 id="active-permission">Active Permission<a class="headerlink" href="#active-permission" title="Permanent link">&para;</a></h3>
<p>Active permission is composed of a set of contract execution permission, like creating an account, trnasfer function, etc.</p>
<p>Active permission's features:</p>
<ol>
<li>the account owns owner permission can change active permission</li>
<li>the account owns the execution permission of AccountPermissionUpdateContract can also change active permission</li>
<li>8 permissions at most</li>
<li>permissionId increases from 2 automatically</li>
<li>when a new account is created, an active permission will be created automatically, and the address will be inserted into it, default weight is 1, keys field only contains this address and weight is 1</li>
</ol>
<h3 id="fee">Fee<a class="headerlink" href="#fee" title="Permanent link">&para;</a></h3>
<ol>
<li>Using AccountPermissionUpdateContract costs 100STB</li>
<li>If a transaction contains 2 or more than 2 signatures, it charges an extra 1 STB besides the transaction fee</li>
<li>The fee can be modified by proposing</li>
</ol>
<h2 id="api">API<a class="headerlink" href="#api" title="Permanent link">&para;</a></h2>
<h3 id="change-permission">Change Permission<a class="headerlink" href="#change-permission" title="Permanent link">&para;</a></h3>
<p><code>AccountPermissionUpdateContract</code>, steps:</p>
<ol>
<li>call <code>getaccount</code> to query the account, get the original permission</li>
<li>change permission</li>
<li>build transaction and sign</li>
<li>send transaction</li>
</ol>
<p>Demo HTTP request:</p>
<div class="codehilite"><pre><span></span><span class="go">// POST to http://{{host}}:{{port}}/wallet/accountpermissionupdate</span>

<span class="go">{</span>
<span class="go">  &quot;owner_address&quot;: &quot;41ffa9466d5bf6bb6b7e4ab6ef2b1cb9f1f41f9700&quot;,</span>
<span class="go">  &quot;owner&quot;: {</span>
<span class="go">    &quot;type&quot;: 0,</span>
<span class="go">    &quot;id&quot;: 0,</span>
<span class="go">    &quot;permission_name&quot;: &quot;owner&quot;,</span>
<span class="go">    &quot;threshold&quot;: 2,</span>
<span class="go">    &quot;keys&quot;: [{</span>
<span class="go">        &quot;address&quot;: &quot;41F08012B4881C320EB40B80F1228731898824E09D&quot;,</span>
<span class="go">        &quot;weight&quot;: 1</span>
<span class="go">      },</span>
<span class="go">      {</span>
<span class="go">        &quot;address&quot;: &quot;41DF309FEF25B311E7895562BD9E11AAB2A58816D2&quot;,</span>
<span class="go">        &quot;weight&quot;: 1</span>
<span class="go">      },</span>
<span class="go">      {</span>
<span class="go">        &quot;address&quot;: &quot;41BB7322198D273E39B940A5A4C955CB7199A0CDEE&quot;,</span>
<span class="go">        &quot;weight&quot;: 1</span>
<span class="go">      }</span>
<span class="go">    ]</span>
<span class="go">  },</span>
<span class="go">  &quot;executive&quot;: {</span>
<span class="go">      &quot;type&quot;: 1,</span>
<span class="go">      &quot;id&quot;: 1,</span>
<span class="go">      &quot;permission_name&quot;: &quot;executive&quot;,</span>
<span class="go">      &quot;threshold&quot;: 1,</span>
<span class="go">      &quot;keys&quot;: [{</span>
<span class="go">          &quot;address&quot;: &quot;41F08012B4881C320EB40B80F1228731898824E09D&quot;,</span>
<span class="go">          &quot;weight&quot;: 1</span>
<span class="go">        }</span>
<span class="go">      ]</span>
<span class="go">    },</span>
<span class="go">  &quot;actives&quot;: [{</span>
<span class="go">    &quot;type&quot;: 2,</span>
<span class="go">    &quot;id&quot;: 2,</span>
<span class="go">    &quot;permission_name&quot;: &quot;active0&quot;,</span>
<span class="go">    &quot;threshold&quot;: 3,</span>
<span class="go">    &quot;operations&quot;: &quot;7fff1fc0037e0000000000000000000000000000000000000000000000000000&quot;,</span>
<span class="go">    &quot;keys&quot;: [{</span>
<span class="go">        &quot;address&quot;: &quot;41F08012B4881C320EB40B80F1228731898824E09D&quot;,</span>
<span class="go">        &quot;weight&quot;: 1</span>
<span class="go">      },</span>
<span class="go">      {</span>
<span class="go">        &quot;address&quot;: &quot;41DF309FEF25B311E7895562BD9E11AAB2A58816D2&quot;,</span>
<span class="go">        &quot;weight&quot;: 1</span>
<span class="go">      },</span>
<span class="go">      {</span>
<span class="go">        &quot;address&quot;: &quot;41BB7322198D273E39B940A5A4C955CB7199A0CDEE&quot;,</span>
<span class="go">        &quot;weight&quot;: 1</span>
<span class="go">      }</span>
<span class="go">    ]</span>
<span class="go">  }]</span>
<span class="go">}</span>
</pre></div>


<h4 id="calculate-the-active-permissions-operations">Calculate the Active Permission's Operations<a class="headerlink" href="#calculate-the-active-permissions-operations" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

  <span class="c1">//you need to specify the id of the contract you need</span>

  <span class="c1">// to give permission to by referring to the definition of Transaction.ContractType</span>

  <span class="c1">// in proto to get the id of the contract, below includes all the contract except AccountPermissionUpdateContract(id=46)</span>

  <span class="n">Integer</span><span class="o">[]</span> <span class="n">contractId</span> <span class="o">=</span> <span class="o">{</span><span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">5</span><span class="o">,</span> <span class="mi">6</span><span class="o">,</span> <span class="mi">8</span><span class="o">,</span> <span class="mi">9</span><span class="o">,</span> <span class="mi">10</span><span class="o">,</span> <span class="mi">11</span><span class="o">,</span> <span class="mi">12</span><span class="o">,</span> <span class="mi">13</span><span class="o">,</span> <span class="mi">14</span><span class="o">,</span> <span class="mi">15</span><span class="o">,</span> <span class="mi">16</span><span class="o">,</span> <span class="mi">17</span><span class="o">,</span> <span class="mi">18</span><span class="o">,</span> <span class="mi">19</span><span class="o">,</span> <span class="mi">20</span><span class="o">,</span> <span class="mi">30</span><span class="o">,</span> <span class="mi">31</span><span class="o">,</span>
      <span class="mi">32</span><span class="o">,</span> <span class="mi">33</span><span class="o">,</span> <span class="mi">41</span><span class="o">,</span> <span class="mi">42</span><span class="o">,</span> <span class="mi">43</span><span class="o">,</span> <span class="mi">44</span><span class="o">,</span> <span class="mi">45</span><span class="o">};</span>
  <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;(</span><span class="n">Arrays</span><span class="o">.</span><span class="na">asList</span><span class="o">(</span><span class="n">contractId</span><span class="o">));</span>
  <span class="kt">byte</span><span class="o">[]</span> <span class="n">operations</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">32</span><span class="o">];</span>
  <span class="n">list</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">e</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="n">operations</span><span class="o">[</span><span class="n">e</span> <span class="o">/</span> <span class="mi">8</span><span class="o">]</span> <span class="o">|=</span> <span class="o">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">e</span> <span class="o">%</span> <span class="mi">8</span><span class="o">);</span>
  <span class="o">});</span>

  <span class="c1">//7fff1fc0033e0000000000000000000000000000000000000000000000000000</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">ByteArray</span><span class="o">.</span><span class="na">toHexString</span><span class="o">(</span><span class="n">operations</span><span class="o">));</span>
<span class="o">}</span>
</pre></div>


<h3 id="contract-execution">Contract Execution<a class="headerlink" href="#contract-execution" title="Permanent link">&para;</a></h3>
<p>(1). Create transaction, the same as none multi-signatures</p>
<p>(2). Specify <code>Permission_id</code>, default 0, represent owner permission</p>
<p>(3). User A sign the transaction, and then send it to user B</p>
<p>(4). User B sign the transaction gets from A, and then send it to user C</p>
<p>......</p>
<p>(n). The last users that signs the transaction broadcast it to the node</p>
<p>(n+1). The node will verify if the sum of the weight of all signatures is bigger than threshold, if true, the transaction is accepted, otherwise, is rejected</p>
<h3 id="other-apis">Other APIs<a class="headerlink" href="#other-apis" title="Permanent link">&para;</a></h3>
<p>Please refer to <a href="../../api/http/">HTTP API</a> and <a href="../../api/rpc/">RPC API</a> for more information.</p>
<ol>
<li>
<p>add signature</p>
<p>```console</p>
<blockquote>
<p>curl -X POST http://127.0.0.1:8090/wallet/addtransactionsign -d '
  {"transaction": "TransferContract", "privateKey": "permissionkey1"}'
```</p>
</blockquote>
<p><code>protobuf
rpc AddSign (TransactionSign) returns (TransactionExtention) {}</code></p>
</li>
<li>
<p>query the addresses that already signed a transaction</p>
<p>```console</p>
<blockquote>
<p>curl -X POST http://127.0.0.1:8090/wallet/getapprovedlist -d '{"transaction"}'
```</p>
</blockquote>
<p><code>protobuf
rpc GetTransactionApprovedList(Transaction) returns (TransactionApprovedList) { }</code></p>
</li>
<li>
<p>query the signature weight of a transaction</p>
<p>```console</p>
<blockquote>
<p>curl -X POST http://127.0.0.1:8090/wallet/getsignweight -d '{"transaction"}'
```</p>
</blockquote>
<p><code>protobuf
rpc GetTransactionSignWeight (Transaction) returns (TransactionSignWeight) {}</code></p>
</li>
</ol>
<h2 id="others">Others<a class="headerlink" href="#others" title="Permanent link">&para;</a></h2>
<p>Since V3.5, what is the change after a new account is created?</p>
<p>When to create a new account, an owner permission and active permission will be generated automatically. Owner permission only contains one key, the weight and threshold are both 1. Active permission also contains one key, the weight and threshold are both 1, and operations is "7fff1fc0033e0000000000000000000000000000000000000000000000000000", means it support the execution of all contracts except AccountPermissionUpdateContract.
After V3.5, if there is a new system contract, the default operations value of the newly created account will change. The operations of existing accounts will not change.</p>
<p>Please refer to <a href="https://github.com/stabilaprotocol/wallet-cli/blob/master/README.md">wallet-cli</a> to check the usage of multi-signature.</p>
<h2 id="fees">Fees<a class="headerlink" href="#fees" title="Permanent link">&para;</a></h2>
<p>If you update your account permission, the fee is 100 STB.</p>
<p>If a transaction is signed by more than 1 account, the fee is 1 STB.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../shielded-SRC20-contract/" class="btn btn-neutral float-right" title="Shielded SRC20 Contract">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../dex/" class="btn btn-neutral" title="Decentralized Exchange"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/stabilaprotocol/documentation-en/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../dex/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../shielded-SRC20-contract/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
